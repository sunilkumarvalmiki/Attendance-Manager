<?xml version="1.0" encoding="UTF-8"?>
<TaskerData sr="" dvi="1" tv="6.2.1">
    <!-- 
        Beehive HCM Attendance Automation
        Version: 1.0
        Author: Antigravity AI
        Description: Automated attendance submission with OTP handling
        
        PROFILES:
        - MorningPunchIn: Triggers at 9:25 AM Mon-Fri
        - EveningPunchOut: Triggers at 6:25 PM Mon-Fri
        
        REQUIREMENTS:
        - Tasker 6.0+
        - AutoInput plugin
        - Beehive HCM mobile app installed
    -->
    
    <!-- =============================================== -->
    <!-- GLOBAL VARIABLES -->
    <!-- =============================================== -->
    <Project sr="proj0" ve="2">
        <name>BeehiveAttendance</name>
        
        <!-- Configuration Variables -->
        <Variable sr="var0">
            <name>%BEEHIVE_USERNAME</name>
            <value></value>
            <encrypted>true</encrypted>
        </Variable>
        
        <Variable sr="var1">
            <name>%BEEHIVE_PASSWORD</name>
            <value></value>
            <encrypted>true</encrypted>
        </Variable>
        
        <Variable sr="var2">
            <name>%REGULARIZE_REASON</name>
            <value>Work from Home</value>
        </Variable>
        
        <Variable sr="var3">
            <name>%OTP_TIMEOUT</name>
            <value>120</value>
            <note>Seconds to wait for OTP</note>
        </Variable>
        
        <Variable sr="var4">
            <name>%RETRY_ATTEMPTS</name>
            <value>3</value>
        </Variable>
        
        <Variable sr="var5">
            <name>%BEEHIVE_APP_PACKAGE</name>
            <value>com.app.beehivehrms</value>
        </Variable>
        
        <!-- Runtime Variables -->
        <Variable sr="var6">
            <name>%OTP_CODE</name>
            <value></value>
        </Variable>
        
        <Variable sr="var7">
            <name>%LAST_RUN_STATUS</name>
            <value></value>
        </Variable>
        
        <Variable sr="var8">
            <name>%ATTENDANCE_LOG</name>
            <value>/sdcard/Tasker/BeehiveAttendance/logs/attendance.log</value>
        </Variable>
    </Project>
    
    <!-- =============================================== -->
    <!-- PROFILES -->
    <!-- =============================================== -->
    
    <!-- Profile: Morning Punch-In -->
    <Profile sr="prof0" ve="2">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <flags>8</flags>
        <id>1</id>
        <mid0>2</mid0>
        <name>MorningPunchIn</name>
        <Time sr="con0">
            <fh>9</fh>
            <fm>25</fm>
            <rep>1</rep>
            <repval>1440</repval>
        </Time>
        <Day sr="con1">
            <daylist>1,2,3,4,5</daylist>
        </Day>
    </Profile>
    
    <!-- Profile: Evening Punch-Out -->
    <Profile sr="prof1" ve="2">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <flags>8</flags>
        <id>3</id>
        <mid0>4</mid0>
        <name>EveningPunchOut</name>
        <Time sr="con0">
            <fh>18</fh>
            <fm>25</fm>
            <rep>1</rep>
            <repval>1440</repval>
        </Time>
        <Day sr="con1">
            <daylist>1,2,3,4,5</daylist>
        </Day>
    </Profile>
    
    <!-- Profile: SMS OTP Receiver -->
    <Profile sr="prof2" ve="2">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <id>5</id>
        <mid0>6</mid0>
        <name>SMSOTPReceiver</name>
        <Event sr="con0" ve="2">
            <code>13</code>
            <Str sr="arg0" ve="3">*</Str>
            <Str sr="arg1" ve="3">*OTP*</Str>
            <Int sr="arg2" val="0"/>
        </Event>
    </Profile>
    
    <!-- =============================================== -->
    <!-- TASKS -->
    <!-- =============================================== -->
    
    <!-- Task: Main Attendance Flow (Morning) -->
    <Task sr="task2">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <id>2</id>
        <name>ExecuteMorningAttendance</name>
        <pri>100</pri>
        
        <!-- Step 1: Initialize -->
        <Action sr="act0" ve="7">
            <code>547</code>
            <Str sr="arg0" ve="3">Starting Morning Attendance Automation</Str>
            <Int sr="arg1" val="0"/>
        </Action>
        
        <!-- Step 2: Check if already run today -->
        <Action sr="act1" ve="7">
            <code>37</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%LAST_RUN_DATE</lhs>
                    <op>2</op>
                    <rhs>%DATE</rhs>
                </Condition>
            </ConditionList>
            <Str sr="arg0" ve="3">Already Run Today</Str>
            <Str sr="arg1" ve="3">Attendance already submitted for today. Exiting.</Str>
            <Int sr="arg2" val="0"/>
            <Int sr="arg3" val="0"/>
        </Action>
        
        <Action sr="act2" ve="7">
            <code>43</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%LAST_RUN_DATE</lhs>
                    <op>2</op>
                    <rhs>%DATE</rhs>
                </Condition>
            </ConditionList>
        </Action>
        
        <!-- Step 3: Check Calendar (Holiday/Leave) -->
        <Action sr="act3" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">CheckCalendar</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <!-- Step 4: Perform Login -->
        <Action sr="act4" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">PerformLogin</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <!-- Step 5: Regularize Previous Day -->
        <Action sr="act5" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">RegularizeAttendance</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <!-- Step 6: Mark Punch In -->
        <Action sr="act6" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">MarkPunchIn</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <!-- Step 7: Send Success Notification -->
        <Action sr="act7" ve="7">
            <code>523</code>
            <Str sr="arg0" ve="3">âœ… Attendance Marked</Str>
            <Str sr="arg1" ve="3">Morning punch-in completed at %TIME</Str>
            <Img sr="arg2" ve="2">
                <var>mw_content_schedule</var>
            </Img>
            <Int sr="arg3" val="0"/>
            <Int sr="arg4" val="2"/>
            <Str sr="arg5" ve="3"/>
        </Action>
        
        <!-- Step 8: Log Success -->
        <Action sr="act8" ve="7">
            <code>410</code>
            <Str sr="arg0" ve="3">%ATTENDANCE_LOG</Str>
            <Str sr="arg1" ve="3">%DATE %TIME | SUCCESS | Morning Punch-In
</Str>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <!-- Step 9: Update Last Run -->
        <Action sr="act9" ve="7">
            <code>547</code>
            <Str sr="arg0" ve="3">%LAST_RUN_DATE</Str>
            <Str sr="arg1" ve="3">%DATE</Str>
            <Int sr="arg2" val="0"/>
            <Int sr="arg3" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Main Attendance Flow (Evening) -->
    <Task sr="task4">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <id>4</id>
        <name>ExecuteEveningAttendance</name>
        <pri>100</pri>
        
        <Action sr="act0" ve="7">
            <code>547</code>
            <Str sr="arg0" ve="3">Starting Evening Punch-Out Automation</Str>
            <Int sr="arg1" val="0"/>
        </Action>
        
        <Action sr="act1" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">PerformLogin</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <Action sr="act2" ve="7">
            <code>130</code>
            <Str sr="arg0" ve="3">MarkPunchOut</Str>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="1"/>
        </Action>
        
        <Action sr="act3" ve="7">
            <code>523</code>
            <Str sr="arg0" ve="3">âœ… Punch-Out Completed</Str>
            <Str sr="arg1" ve="3">Evening punch-out at %TIME</Str>
            <Img sr="arg2" ve="2">
                <var>mw_content_schedule</var>
            </Img>
            <Int sr="arg3" val="0"/>
            <Int sr="arg4" val="2"/>
        </Action>
        
        <Action sr="act4" ve="7">
            <code>410</code>
            <Str sr="arg0" ve="3">%ATTENDANCE_LOG</Str>
            <Str sr="arg1" ve="3">%DATE %TIME | SUCCESS | Evening Punch-Out
</Str>
            <Int sr="arg2" val="1"/>
        </Action>
    </Task>
    
    <!-- Task: Extract OTP from SMS -->
    <Task sr="task6">
        <cdate>1732468800000</cdate>
        <edate>1732468800000</edate>
        <id>6</id>
        <name>ExtractOTP_SMS</name>
        <pri>100</pri>
        
        <!-- Triggered by SMS received event -->
        <Action sr="act0" ve="7">
            <code>590</code>
            <Str sr="arg0" ve="3">SMS Body: %SMSRB</Str>
            <Int sr="arg1" val="0"/>
        </Action>
        
        <!-- Extract OTP using regex -->
        <Action sr="act1" ve="7">
            <code>590</code>
            <Bundle sr="arg0">
                <d>
                    <k>searchreplace</k>
                    <v>true</v>
                </d>
                <d>
                    <k>variable</k>
                    <v>%SMSRB</v>
                </d>
                <d>
                    <k>search</k>
                    <v>\b(\d{4,6})\b</v>
                </d>
                <d>
                    <k>store_matches_in</k>
                    <v>%OTP_CODE</v>
                </d>
                <d>
                    <k>replace</k>
                    <v>false</v>
                </d>
            </Bundle>
        </Action>
        
        <!-- Flash extracted OTP -->
        <Action sr="act2" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">OTP Extracted: %OTP_CODE(1)</Str>
            <Int sr="arg1" val="0"/>
        </Action>
        
        <!-- Store in global variable -->
        <Action sr="act3" ve="7">
            <code>547</code>
            <Str sr="arg0" ve="3">%OTP_CODE</Str>
            <Str sr="arg1" ve="3">%OTP_CODE(1)</Str>
            <Int sr="arg2" val="0"/>
            <Int sr="arg3" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Check Calendar -->
    <Task sr="task7">
        <id>7</id>
        <name>CheckCalendar</name>
        
        <!-- Get current day of week -->
        <Action sr="act0" ve="7">
            <code>590</code>
            <Str sr="arg0" ve="3">%DAYW</Str>
            <Int sr="arg1" val="0"/>
        </Action>
        
        <!-- Check if weekend -->
        <Action sr="act1" ve="7">
            <code>37</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%DAYW</lhs>
                    <op>2</op>
                    <rhs>Sat|Sun</rhs>
                </Condition>
            </ConditionList>
            <Str sr="arg0" ve="3">Weekend Detected</Str>
            <Str sr="arg1" ve="3">Skipping attendance - Weekend</Str>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <Action sr="act2" ve="7">
            <code>43</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%DAYW</lhs>
                    <op>2</op>
                    <rhs>Sat|Sun</rhs>
                </Condition>
            </ConditionList>
        </Action>
        
        <!-- TODO: Add holiday checking via calendar API -->
        <Action sr="act3" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">Calendar check passed - Weekday</Str>
            <Int sr="arg1" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Perform Login -->
    <Task sr="task8">
        <id>8</id>
        <name>PerformLogin</name>
        
        <!-- Launch Beehive App -->
        <Action sr="act0" ve="7">
            <code>22</code>
            <Str sr="arg0" ve="3">%BEEHIVE_APP_PACKAGE</Str>
            <Str sr="arg1" ve="3"/>
            <Int sr="arg2" val="0"/>
            <Int sr="arg3" val="0"/>
        </Action>
        
        <!-- Wait for app to load -->
        <Action sr="act1" ve="7">
            <code>30</code>
            <Int sr="arg0" val="3"/>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="0"/>
            <Int sr="arg3" val="0"/>
            <Int sr="arg4" val="0"/>
        </Action>
        
        <!-- AutoInput: Check if already logged in -->
        <Action sr="act2" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>element_present</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Login</v>
                </d>
                <d>
                    <k>easy_mode</k>
                    <v>true</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- If Login button exists, perform login -->
        <Action sr="act3" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%aitext</lhs>
                    <op>12</op>
                    <rhs>Login</rhs>
                </Condition>
            </ConditionList>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>field_type</k>
                    <v>input_username</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Enter Username -->
        <Action sr="act4" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%aitext</lhs>
                    <op>12</op>
                    <rhs>Login</rhs>
                </Condition>
            </ConditionList>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>input_text</v>
                </d>
                <d>
                    <k>field_type</k>
                    <v>username</v>
                </d>
                <d>
                    <k>text</k>
                    <v>%BEEHIVE_USERNAME</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Enter Password -->
        <Action sr="act5" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%aitext</lhs>
                    <op>12</op>
                    <rhs>Login</rhs>
                </Condition>
            </ConditionList>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>input_text</v>
                </d>
                <d>
                    <k>field_type</k>
                    <v>password</v>
                </d>
                <d>
                    <k>text</k>
                    <v>%BEEHIVE_PASSWORD</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Click Login Button -->
        <Action sr="act6" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%aitext</lhs>
                    <op>12</op>
                    <rhs>Login</rhs>
                </Condition>
            </ConditionList>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Login</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Wait for OTP screen -->
        <Action sr="act7" ve="7">
            <code>30</code>
            <Int sr="arg0" val="5"/>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <!-- Clear previous OTP -->
        <Action sr="act8" ve="7">
            <code>547</code>
            <Str sr="arg0" ve="3">%OTP_CODE</Str>
            <Str sr="arg1" ve="3"/>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <!-- Click Send OTP or trigger OTP -->
        <Action sr="act9" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Send OTP|Get OTP</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Wait for OTP SMS (max 2 minutes) -->
        <Action sr="act10" ve="7">
            <code>809</code>
            <Str sr="arg0" ve="3">%OTP_CODE</Str>
            <Int sr="arg1" val="120"/>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <!-- Enter OTP -->
        <Action sr="act11" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <ConditionList sr="if">
                <Condition sr="c0" ve="3">
                    <lhs>%OTP_CODE</lhs>
                    <op>12</op>
                    <rhs>*</rhs>
                </Condition>
            </ConditionList>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>input_text</v>
                </d>
                <d>
                    <k>field_type</k>
                    <v>otp</v>
                </d>
                <d>
                    <k>text</k>
                    <v>%OTP_CODE</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Click Submit/Verify OTP -->
        <Action sr="act12" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Submit|Verify|Continue</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Wait for home screen -->
        <Action sr="act13" ve="7">
            <code>30</code>
            <Int sr="arg0" val="3"/>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <Action sr="act14" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">Login successful</Str>
            <Int sr="arg1" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Regularize Attendance (Previous Day) -->
    <Task sr="task9">
        <id>9</id>
        <name>RegularizeAttendance</name>
        
        <!-- Navigate to Menu -->
        <Action sr="act0" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>menu_icon</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act1" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click Attendance -->
        <Action sr="act2" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Attendance</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act3" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click Regularize Attendance -->
        <Action sr="act4" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Regularize|Attendance Regularization</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act5" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Calculate previous day date -->
        <Action sr="act6" ve="7">
            <code>590</code>
            <Bundle sr="arg0">
                <d>
                    <k>variable</k>
                    <v>%YESTERDAY</v>
                </d>
                <d>
                    <k>value</k>
                    <v>%DATE - 1</v>
                </d>
            </Bundle>
        </Action>
        
        <!-- Click Date Selector -->
        <Action sr="act7" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>select_regu_date|date_picker</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act8" ve="7">
            <code>30</code>
            <Int sr="arg0" val="1"/>
        </Action>
        
        <!-- Select Yesterday's Date -->
        <Action sr="act9" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>%YESTERDAY</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Enter Reason -->
        <Action sr="act10" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>input_text</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>reason|eg_reason</v>
                </d>
                <d>
                    <k>text</k>
                    <v>%REGULARIZE_REASON</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <!-- Click Submit -->
        <Action sr="act11" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>reg_submit|submit_button</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act12" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click OK on confirmation -->
        <Action sr="act13" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>OK|Confirm</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act14" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">Regularized attendance for %YESTERDAY</Str>
            <Int sr="arg1" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Mark Punch In -->
    <Task sr="task10">
        <id>10</id>
        <name>MarkPunchIn</name>
        
        <!-- Navigate back to home -->
        <Action sr="act0" ve="7">
            <code>20</code>
            <Int sr="arg0" val="4"/>
            <Int sr="arg1" val="0"/>
            <Int sr="arg2" val="0"/>
        </Action>
        
        <Action sr="act1" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click menu -->
        <Action sr="act2" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>menu_icon</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act3" ve="7">
            <code>30</code>
            <Int sr="arg0" val="1"/>
        </Action>
        
        <!-- Click Attendance -->
        <Action sr="act4" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Attendance</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act5" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click Multi Punch -->
        <Action sr="act6" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Multi Punch|Daily Attendance</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act7" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <!-- Click Mark Punch button -->
        <Action sr="act8" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Mark Punch|Punch In</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act9" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <Action sr="act10" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">âœ… Punch-In marked successfully</Str>
            <Int sr="arg1" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: Mark Punch Out -->
    <Task sr="task11">
        <id>11</id>
        <name>MarkPunchOut</name>
        
        <!-- Similar to MarkPunchIn but for evening -->
        <Action sr="act0" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>resource_id</k>
                    <v>menu_icon</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act1" ve="7">
            <code>30</code>
            <Int sr="arg0" val="1"/>
        </Action>
        
        <Action sr="act2" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Attendance</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act3" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <Action sr="act4" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Multi Punch|Daily Attendance</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act5" ve="7">
            <code>30</code>
            <Int sr="arg0" val="2"/>
        </Action>
        
        <Action sr="act6" ve="7">
            <code>com.joaomgcd.autoinput.intent.IntentAction</code>
            <Bundle sr="arg0">
                <d>
                    <k>action</k>
                    <v>click</v>
                </d>
                <d>
                    <k>text</k>
                    <v>Mark Punch|Punch Out</v>
                </d>
            </Bundle>
            <Str sr="arg1" ve="3">com.joaomgcd.autoinput</Str>
        </Action>
        
        <Action sr="act7" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">âœ… Punch-Out marked successfully</Str>
            <Int sr="arg1" val="0"/>
        </Action>
    </Task>
    
    <!-- Task: First Time Setup -->
    <Task sr="task12">
        <id>12</id>
        <name>FirstTimeSetup</name>
        
        <Action sr="act0" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">ðŸš€ Welcome to Beehive Attendance Automation</Str>
            <Int sr="arg1" val="1"/>
        </Action>
        
        <!-- Prompt for username -->
        <Action sr="act1" ve="7">
            <code>590</code>
            <Bundle sr="arg0">
                <d>
                    <k>input_type</k>
                    <v>text</v>
                </d>
                <d>
                    <k>title</k>
                    <v>Beehive Username</v>
                </d>
                <d>
                    <k>message</k>
                    <v>Enter your Beehive login username</v>
                </d>
                <d>
                    <k>variable</k>
                    <v>%BEEHIVE_USERNAME</v>
                </d>
            </Bundle>
        </Action>
        
        <!-- Prompt for password -->
        <Action sr="act2" ve="7">
            <code>590</code>
            <Bundle sr="arg0">
                <d>
                    <k>input_type</k>
                    <v>password</v>
                </d>
                <d>
                    <k>title</k>
                    <v>Beehive Password</v>
                </d>
                <d>
                    <k>message</k>
                    <v>Enter your Beehive login password (stored securely)</v>
                </d>
                <d>
                    <k>variable</k>
                    <v>%BEEHIVE_PASSWORD</v>
                </d>
            </Bundle>
        </Action>
        
        <!-- Prompt for regularize reason -->
        <Action sr="act3" ve="7">
            <code>590</code>
            <Bundle sr="arg0">
                <d>
                    <k>input_type</k>
                    <v>text</v>
                </d>
                <d>
                    <k>title</k>
                    <v>Default Regularize Reason</v>
                </d>
                <d>
                    <k>message</k>
                    <v>Enter default reason (e.g., "Work from Home")</v>
                </d>
                <d>
                    <k>default_value</k>
                    <v>Work from Home</v>
                </d>
                <d>
                    <k>variable</k>
                    <v>%REGULARIZE_REASON</v>
                </d>
            </Bundle>
        </Action>
        
        <Action sr="act4" ve="7">
            <code>548</code>
            <Str sr="arg0" ve="3">âœ… Setup Complete! Automation will run at 9:25 AM &amp; 6:25 PM (Mon-Fri)</Str>
            <Int sr="arg1" val="1"/>
        </Action>
        
        <!-- Create log directory -->
        <Action sr="act5" ve="7">
            <code>410</code>
            <Str sr="arg0" ve="3">/sdcard/Tasker/BeehiveAttendance/logs/</Str>
            <Str sr="arg1" ve="3"/>
            <Int sr="arg2" val="0"/>
        </Action>
    </Task>
    
</TaskerData>
